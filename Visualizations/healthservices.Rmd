---
title: "Health and Social Services"
author: "Amanda E. Ljuba"
date: '2022-06-29'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(ggplot2)
library(dplyr)
library(plotly)
library(readxl)
read_excel("respons.xlsx")
health <- read_excel("respons.xlsx")
subset_health <- health[11:16,c(1,3)]
school <- subset_health$Timestamp
num <- subset_health$`Name of person submitting this report:`
```

```{r}
s <- ggplot(subset_health,aes(x=school,y=num,fill=school))+geom_col()+labs(title="Number of Students Assisted with Health and Social Services",x="School",y="Total") + scale_fill_discrete(name = "") + geom_text(aes(label = num, y = num), size = 3, position = position_stack(vjust = 1.01))
ggplotly(s)
```
Sterling had the largest number of students assisted with health and social services followed by Sugarland and Forest Grove. Sully, Guilford, and Rolling Ridge had below 21 students receieve services.
```{r}
subset_health2 <- health[11:16,c(1,5)]
school2 <- subset_health2$Timestamp
num2 <- subset_health2$`How many students received socio-cultural assessments?`
num2 <- as.numeric(num2)
h <- ggplot(subset_health,aes(x=school2,y=num2,fill=school))+geom_col()+labs(title="Number of Families Referred to Rental/Housing Assistance",x="School",y="Total") + scale_fill_discrete(name = "") + geom_text(aes(label = num2, y = num2), size = 3, position = position_stack(vjust = 1.01))
ggplotly(h)
```

Sully and Guilford families between 30 and 47 families receive rental/housing assistance while all other schools had 5 families or less receieve assistance.
```{r}
subset_health3 <- health[11:16,c(1,6)]
school3 <- subset_health3$Timestamp
num3 <- subset_health3$`How many students received case management by a social worker?`
num3 <- as.numeric(num3)
c <- ggplot(subset_health,aes(x=school3,y=num3,fill=school))+geom_col()+labs(title="Number of Families Who Received Clothing",x="School",y="Total",subtitle="From school closet or community partners") + scale_fill_discrete(name = "")  + geom_text(aes(label = num3, y = num3), size = 3, position = position_stack(vjust = 1.01))
ggplotly(c)
```
Guilford has a large number of families who received clothing resources followed by Sugarland and Sterling who received around 150 clothing resources. Sully, Rolling Ridge and Forest Grove received a very low number of clothing resources.

```{r}
subset_health4 <- health[11:16,c(1,10)]
school4 <- subset_health4$Timestamp
num4 <- subset_health4$`How did your school assist students and families with mental health needs?`
num4 <- as.numeric(num4)
y <-ggplot(subset_health,aes(x=school4,y=num4,fill=school))+geom_col()+labs(title="Number of Students Who Participated in Youth Development Activities",x="School",y="Total") + scale_fill_discrete(name = "")  + geom_text(aes(label = num4, y = num4), size = 3, position = position_stack(vjust = 1.01))
ggplotly(y)
```

Sterling had the largest number of students who participated in youth developent activities followed by Sully. Sugarland and Rolling Ridge only had about 25 students while Guilford had 2 and Forest Grove had none.