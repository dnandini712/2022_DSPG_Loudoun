---
title: "Wages distribution"
author: "Abdullah Rizwan"
date: '2022-06-13'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(tidycensus)
library(viridis)
```

```{r}
library(readxl)
library(ggplot2)
library(dplyr)
library(tidyverse)
sterling <- read_excel("C:/Users/abdul/Downloads/DSPG/Employmentsterling.xlsx",skip=2,col_names=TRUE)
subset_sterling <- sterling[83:102,c(1, 2:5)]
subset_sterling$`WAGES DISTRIBUTION`
subset_sterling$Label <- as.factor(subset_sterling$`WAGES DISTRIBUTION`)
```

```{r}
sterling$...2[53:102]
wages_estimate <- sterling$...2[53:102]
wages_estimate<- as.numeric(gsub(",", "", wages_estimate))
wag_name <- subset_sterling$`WAGES DISTRIBUTION`
#summed_edu <- subset_sterling %>% 
 # group_by(`EMPLOYMENT STATUS`) %>%
  #summarize(edu_sum = sum(employment_estimate))
#summed_edu1 <- summed_edu[-(10:15),]
```

```{r}
ggplot(subset_sterling,aes(subset_sterling$Label, wages_estimate, fill = Label)) + geom_col() +
  theme(axis.text.x = element_text(angle=90))
```

```{r}

ggplot(subset_sterling,aes(subset_sterling$Label, wages_estimate, fill=Label)) + geom_col() +
  theme(axis.text.x = element_text(angle=90)) + coord_polar() + scale_y_log10()
```

bar graph for wages distribution
```{r}
subset_sterling <- sterling[c(57:66),]
emply.fac <- factor(subset_sterling$`EMPLOYMENT STATUS`, levels =subset_sterling$`EMPLOYMENT STATUS`)
percNum <- c()
for(i in 1:10){
  percNum <- c(percNum, as.numeric(sub("%", "", subset_sterling[i, "...4"])))
}
subset_sterling[, "...4"] <- percNum
ggplot(subset_sterling, aes(x = emply.fac, y = ...4, fill = emply.fac)) + geom_bar(position = "stack", stat="identity") + labs(x = "Income ($)", y= "Percentage", caption = " Source : DP03 ACS data 2016-2020", titlel = "Mean Household Income") + coord_flip()+ guides(fill = guide_legend(title = "Income Brackets"))
```
The bar graph above shows the mean household income for the sterling area. The mean income bracket of $100,000 to $149,999 has the greatest amount of population percentage of more than 20%. Followed by the income bracket of $200,000 or more with just a little over 15% of population. Income brackets ranging from less then $10,000 up till $34,999 are all lest than 5% of the population. This shows that the sterling area is a rich neighborhood but also has a few pockets where people are less advantaged.  

