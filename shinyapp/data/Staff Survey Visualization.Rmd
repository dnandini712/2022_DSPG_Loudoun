---
title: "Staff Survey Visualizations"
author: "NDP"
date: '2022-06-29'
output: html_document
---

```{r}
library(ggplot2)
library(plotly)
library(readxl)
library(dplyr)
library(ggplot2)
library(tidycensus)
```

Q1: visualization
```{r}
staffsurvey <- read_excel(paste0(getwd(), "/Loudoun_staffsurvey.xlsx"), col_names = TRUE)
subset_staffsurveyQ1 <- staffsurvey[1:6,1:2]

staffschools1 <- subset_staffsurveyQ1$Schools
staffquestion1 <- subset_staffsurveyQ1$`Q1.  Teachers and other adults at this school support one another to meet the needs of all students.`

staffquestion1 <- subset_staffsurveyQ1$`Q1.  Teachers and other adults at this school support one another to meet the needs of all students.`*100

staffquestion1 <- as.numeric(staffquestion1)

uno <- ggplot(subset_staffsurveyQ1,aes(x=staffschools1,y=staffquestion1,fill=staffschools1))+geom_col()+labs(title="Teachers and other adults at this school support one another to meet the needs of all students",x="School",y="Percent") + scale_fill_discrete(name = "") + geom_text(aes(label = staffquestion1, y = staffquestion1), size = 3, position = position_stack(vjust = 1.02))

ggplotly(uno)
```
100% of staff at Sterling agree that teachers and other adults at the school support one another to meet the needs of … followed by Guilford and Rolling Ridge at 97%, Sully at 96% and Sugarland at 93%. Conversely, only 82% of staff agree with that statement at Forest Grove.

Q2: visualization
```{r}
staffsurvey <- read_excel(paste0(getwd(), "/Loudoun_staffsurvey.xlsx"), col_names = TRUE)
subset_staffsurveyQ2 <- staffsurvey[1:6,c(1,3)]

staffschools2 <- subset_staffsurveyQ2$Schools
staffquestion2 <- subset_staffsurveyQ2$`Q3.  Teachers and other adults at this school provide students the support they need to succeed.`

staffquestion2 <- subset_staffsurveyQ2$`Q3.  Teachers and other adults at this school provide students the support they need to succeed.`*100

staffquestion2 <- as.numeric(staffquestion2)

dos <- ggplot(subset_staffsurveyQ2,aes(x=staffschools2,y=staffquestion2,fill=staffschools2))+geom_col()+labs(title="Teachers and other adults at this school provide \n students the support they need to succeed",x="School",y="Percent") + scale_fill_discrete(name = "") + geom_text(aes(label = staffquestion2, y = staffquestion2), size = 3, position = position_stack(vjust = 1.02))

ggplotly(dos)
```
100% of staff at Guilford and Sterling agree that teachers and other adults at the school provide students the support they need to succeed followed by Rolling Ridge and Sully at 98% and Sugarland at 96%. Conversely, only 89% of staff at Forest Grove agree with this statement.

Q3: visualization
```{r}
staffsurvey <- read_excel(paste0(getwd(), "/Loudoun_staffsurvey.xlsx"), col_names = TRUE)
subset_staffsurveyQ3 <- staffsurvey[1:6,c(1,4)]

staffschools3 <- subset_staffsurveyQ3$Schools
staffquestion3 <- subset_staffsurveyQ3$`Q5. I feel comfortable raising issues and concerns that are important to me with school administrators.`

staffquestion3 <- subset_staffsurveyQ3$`Q5. I feel comfortable raising issues and concerns that are important to me with school administrators.`*100

staffquestion3 <- as.numeric(staffquestion3)

tres <- ggplot(subset_staffsurveyQ3,aes(x=staffschools3,y=staffquestion3,fill=staffschools3))+geom_col()+labs(title="I feel comfortable raising issues and concerns that \n are important to me with school administrators",x="School",y="Percent") + scale_fill_discrete(name = "") + geom_text(aes(label = staffquestion3, y = staffquestion3), size = 3, position = position_stack(vjust = 1.02))

ggplotly(tres)
```
only 3 out of the six schools have over 80 percent of teachers who feel comfotrable raising issues and concerns that are important to them with their school administrators which is exceedengly low compared to the high percentages of the other graphs. two schools, sterling and sugarland sit at 70 percent but forest groves teachers are less than 70! This could be something to look into 

Q4: visualization
```{r}
staffsurvey <- read_excel(paste0(getwd(), "/Loudoun_staffsurvey.xlsx"), col_names = TRUE)
subset_staffsurveyQ4 <- staffsurvey[1:6,c(1,5)]

staffschools4 <- subset_staffsurveyQ4$Schools
staffquestion4 <- subset_staffsurveyQ4$`Q6.  This school’s administrators support the professional development of staff.`

staffquestion4 <- subset_staffsurveyQ4$`Q6.  This school’s administrators support the professional development of staff.`*100

staffquestion4 <- as.numeric(staffquestion4)

quatro <- ggplot(subset_staffsurveyQ4,aes(x=staffschools4,y=staffquestion4,fill=staffschools4))+geom_col()+labs(title="This school’s administrators support the professional development of staff",x="School",y="Percent") + scale_fill_discrete(name = "") + geom_text(aes(label = staffquestion4, y = staffquestion4), size = 3, position = position_stack(vjust = 1.02))

ggplotly(quatro)
```
most of the schools have over 90 percent of staff who feel like their school administrators support their professional development. this is generally a good thing, with 98 percent of staff at sully and guilford believing that. forest grove has the least amount of staff (in percent) who believe this. 

Q5: visualization
```{r}
staffsurvey <- read_excel(paste0(getwd(), "/Loudoun_staffsurvey.xlsx"), col_names = TRUE)
subset_staffsurveyQ5 <- staffsurvey[1:6,c(1,6)]

staffschools5 <- subset_staffsurveyQ5$Schools
staffquestion5 <- subset_staffsurveyQ5$`Q22.  Teachers and other adults provide useful information to parents and guardians to support their children's learning at home.`

staffquestion5 <- subset_staffsurveyQ5$`Q22.  Teachers and other adults provide useful information to parents and guardians to support their children's learning at home.`*100

staffquestion5 <- as.numeric(staffquestion5)

cinco <- ggplot(subset_staffsurveyQ5,aes(x=staffschools5,y=staffquestion5,fill=staffschools5))+geom_col()+labs(title="Teachers and other adults provide useful information to parents and guardians \n to support their children's learning at home",x="School",y="Percent") + scale_fill_discrete(name = "") + geom_text(aes(label = staffquestion5, y = staffquestion5), size = 3, position = position_stack(vjust = 1.02))

ggplotly(cinco)
```
almost 90 percent of staff at all schools feel as though their they and their peeers provide useful information to their students parents and gaurdians to support their students learning at home

Q6: visualization
```{r}
staffsurvey <- read_excel(paste0(getwd(), "/Loudoun_staffsurvey.xlsx"), col_names = TRUE)
subset_staffsurveyQ6 <- staffsurvey[1:6,c(1,7)]

staffschools6 <- subset_staffsurveyQ6$Schools
staffquestion6 <- subset_staffsurveyQ6$`Q40.  Class sizes are reasonable such that teachers have the time available to meet the needs of all students.`

staffquestion6 <- subset_staffsurveyQ6$`Q40.  Class sizes are reasonable such that teachers have the time available to meet the needs of all students.`*100

staffquestion6 <- as.numeric(staffquestion6)

sies <- ggplot(subset_staffsurveyQ6,aes(x=staffschools6,y=staffquestion6,fill=staffschools6))+geom_col()+labs(title="Class sizes are reasonable such that teachers have the \n time available to meet the needs of all students",x="School",y="Percent") + scale_fill_discrete(name = "") + geom_text(aes(label = staffquestion6, y = staffquestion6), size = 3, position = position_stack(vjust = 1.02))

ggplotly(sies)
```
At Sterling, 90% of staff agree that class sizes are reasonable while only 81% agree at Sully and 76% agree at Rolling Ridge. Alternatively, only 67% of staff agree with this statement at Sugarland and 62% at Guilford agree. Still, only 45% of staff at Forest Grove agree with this statement.

Q7: visualization
```{r}
staffsurvey <- read_excel(paste0(getwd(), "/Loudoun_staffsurvey.xlsx"), col_names = TRUE)
subset_staffsurveyQ7 <- staffsurvey[1:6,c(1,8)]

staffschools7 <- subset_staffsurveyQ7$Schools
staffquestion7 <- subset_staffsurveyQ7$`Q56. Overall, my school is a good place to work and learn.`

staffquestion7 <- subset_staffsurveyQ7$`Q56. Overall, my school is a good place to work and learn.`*100

staffquestion7 <- as.numeric(staffquestion7)

siete <- ggplot(subset_staffsurveyQ7,aes(x=staffschools7,y=staffquestion7,fill=staffschools7))+geom_col()+labs(title="Overall, my school is a good place to work and learn",x="School",y="Percent") + scale_fill_discrete(name = "") + geom_text(aes(label = staffquestion7, y = staffquestion7), size = 3, position = position_stack(vjust = 1.02))

ggplotly(siete)
```
Shows that students are comfortable with the school environment. They like the atmosphere and people around them. Students feel like home at school. Rolling Ridge has the highest percentage of 97%. Forest Grove has the least amount of students satisfied with 79%.



