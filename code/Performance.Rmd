---
title: "Performance/Grades"
author: "Leonard-Allen"
date: '2022-06-15'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#Loading the packages
```{r include=FALSE}
library(ggplot2)
library(dplyr)
library(tidyverse)
library(readxl)
library(readr)
```



# Importing the data
## Data has following variables to consider:
- Percent Pass
- Percent Proficiency
- Advance
- Fail
- Total number
```{r message=FALSE, warning=FALSE}
#Assessments <- read_csv("C:/Users/Leo Allen/Desktop/DSPG/2022_DSPG_Loudoun/data/raw/Assessments.csv", 
#                        col_names = T, skip = 2)

#I have an excel cleaned version
Assessments <- read_excel("C:/Users/Leo Allen/Desktop/DSPG/2022_DSPG_Loudoun/data/new/Assessments.xlsx")

#View(Assessments)
#str(Assessments)
```

```{r}
as.factor(Assessments$Year) %>% str()
as.factor(Assessments$Division) %>% str()
as.factor(Assessments$School) %>% str()
as.factor(Assessments$Subgroup) %>% str()
as.factor(Assessments$`Test Level`) %>% str()
as.factor(Assessments$`Subject Area`) %>% str()
as.factor(Assessments$Subject) %>% str()
```

# subsetting the data for each school
```{r}
#for all students
ALL6 <- Assessments[which(Assessments$Subgroup=="All Students"),] #getting for all students

#individual schools
Guilford <- Assessments[which(Assessments$School == "Guilford Elementary"),]
Forest <- Assessments[which(Assessments$School == "Forest Grove Elementary"),]
Rolling <- Assessments[which(Assessments$School == "Rolling Ridge Elementary"),]
Sterling <- Assessments[which(Assessments$School == "Sterling Elementary"),]
Sugar <- Assessments[which(Assessments$School == "Sugarland Elementary"),]
Sully <- Assessments[which(Assessments$School == "Sully Elementary"),]
```


```{r include=FALSE}
# Dont run this chunk, used as a test only
# Making the year discrete
#Year <- c("2018/2019","2020/2021") %>% as.factor()
```


# More work needs to be done here for the color pallette
```{r}
ALL6 %>% 
  arrange(Subject) %>% #the column you'd like to be arranged into order)   %>% 
  group_by(School) %>%  ggplot(aes(x = Year, y = `Percent Pass`, fill = `Subject`)) + geom_bar(stat="identity") + labs(title='Academic Performance For Elementary School by Subject', caption = "Source: VDOE \n No data for 2019/2020 due to COVID/school closure") + facet_wrap("School") 
#+  scale_fill_viridis_c(breaks = c(breaks you’d like), option = "E") # change the option if you’d like to change the theme of the palette

  ALL6 %>% arrange(Subject) %>% #the column you'd like to be arranged into order)   %>% 
group_by(School) %>%  ggplot(aes(x = Year, y = `Percent Pass`, fill = `Percent Pass`)) + geom_bar(stat="identity") + labs(title='Academic Performance For Elementary School by Subject', caption = "Source: VDOE \n No data for 2019/2020 due to COVID/school closure") + facet_wrap("School") 
```

# Schools' Percent Pass
## Forest Grove Elementary
```{r}
FGE_All <- Forest[which(Forest$Subgroup=="All Students"),] 

#filter for only subjects
FGE_eng <- Forest[which(Forest$Subject=="English Reading"),] 
#Use ggplot
#plot(Year, FGE_eng$`Percent Pass`)

FGE_math <- Forest[which(Forest$Subject=="Mathematics"),] 
#Use ggplot
#plot(Year, FGE_math$`Percent Pass`)

FGE_sci <- Forest[which(Forest$Subject=="Science"),]
#Use ggplot
#plot(Year, FGE_sci$`Percent Pass`)


FGE_All %>% 
  arrange(Subject) %>% #the column you'd like to be arranged into order)   %>% 
  group_by(School) %>%  ggplot(aes(x = Year, y = `Percent Pass`, fill = `Percent Pass`)) + geom_bar(stat="identity") + labs(title='Forest Grove Elementary Academic Performance for Forest Grove',caption = "Source: VDOE \n No data for 2019/2020 due to COVID/school closure") + facet_wrap("Subject") 



EMS1 <- rbind(FGE_eng, FGE_math, FGE_sci)
FEMS <- EMS1[which(EMS1$Subgroup=="All Students"),] 

FEMS %>% 
  arrange(Subject) %>% #the column you'd like to be arranged into order)   %>% 
  group_by(School) %>%  ggplot(aes(x = Year, y = `Percent Pass`, fill = `Percent Pass`)) + geom_bar(stat="identity") + labs(title='Forest Grove Elementary Academic Performance', caption = "Source: VDOE \n No data for 2019/2020 due to COVID/school closure") + facet_wrap("Subject")


```

## Guilford Elementary
```{r}
GUIL_All <- Guilford[which(Guilford$Subgroup=="All Students"),] 

#filter for only subjects
GUIL_eng <- Guilford[which(Guilford$Subject=="English Reading"),] 
#Use ggplot
#plot(Year, GUIL_eng$`Percent Pass`)

GUIL_math <- Guilford[which(Guilford$Subject=="Mathematics"),] 
#Use ggplot
#plot(Year, GUIL_math$`Percent Pass`)

GUIL_sci <- Guilford[which(Guilford$Subject=="Science"),]
#Use ggplot
#plot(Year, GUIL_sci$`Percent Pass`)

GUIL_All %>% 
  arrange(Subject) %>% #the column you'd like to be arranged into order)   %>% 
  group_by(School) %>%  ggplot(aes(x = Year, y = `Percent Pass`, fill = `Percent Pass`)) + geom_bar(stat="identity") + labs(title='Guilford Elementary Academic Performance', caption = "Source: VDOE \n No data for 2019/2020 due to COVID/school closure") + facet_wrap("Subject") 

EMS2 <- rbind(GUIL_eng, GUIL_math, GUIL_sci)
GEMS <- EMS2[which(EMS2$Subgroup=="All Students"),] 

GEMS %>% 
  arrange(Subject) %>% #the column you'd like to be arranged into order)   %>% 
  group_by(School) %>%  ggplot(aes(x = Year, y = `Percent Pass`, fill = `Percent Pass`)) + geom_bar(stat="identity") + labs(title='Guilford Elementary Academic Performance', caption = "Source: VDOE \n No data for 2019/2020 due to COVID/school closure") + facet_wrap("Subject")

```


## Rolling Ridge
```{r}
ROLL_All <- Rolling[which(Rolling$Subgroup=="All Students"),] 

#filter for only subjects
ROLL_eng <- Rolling[which(Rolling$Subject=="English Reading"),] 
#Use ggplot
#plot(Year, ROLL_eng$`Percent Pass`)

ROLL_math <- Rolling[which(Rolling$Subject=="Mathematics"),] 
#Use ggplot
#plot(Year, ROLL_math$`Percent Pass`)

ROLL_sci <- Rolling[which(Rolling$Subject=="Science"),]
#Use ggplot
#plot(Year, ROLL_sci$`Percent Pass`)

ROLL_All %>% 
  arrange(Subject) %>% #the column you'd like to be arranged into order)   %>% 
  group_by(School) %>%  ggplot(aes(x = Year, y = `Percent Pass`, fill = `Percent Pass`)) + geom_bar(stat="identity") + labs(title='Rolling Ridge Elementary Academic Performance', caption = "Source: VDOE \n No data for 2019/2020 due to COVID/school closure") + facet_wrap("Subject")


EMS3 <- rbind(ROLL_eng, ROLL_math, ROLL_sci)
REMS <- EMS3[which(EMS3$Subgroup=="All Students"),] 

REMS %>% 
  arrange(Subject) %>% #the column you'd like to be arranged into order)   %>% 
  group_by(School) %>%  ggplot(aes(x = Year, y = `Percent Pass`, fill = `Percent Pass`)) + geom_bar(stat="identity") + labs(title='Rolling Ridge Elementary Academic Performance', caption = "Source: VDOE \n No data for 2019/2020 due to COVID/school closure") + facet_wrap("Subject")


```


## Sterling
```{r}
STER_All <- Sterling[which(Sterling$Subgroup=="All Students"),] 

#filter for only subjects
STER_eng <- Sterling[which(Sterling$Subject=="English Reading"),] 
#Use ggplot
#plot(Year, STER_eng$`Percent Pass`)

STER_math <- Sterling[which(Sterling$Subject=="Mathematics"),] 
#Use ggplot
#plot(Year, STER_math$`Percent Pass`)

STER_sci <- Sterling[which(Sterling$Subject=="Science"),]
#Use ggplot
#plot(Year, STER_sci$`Percent Pass`)

STER_All %>% 
  arrange(Subject) %>% #the column you'd like to be arranged into order)   %>% 
  group_by(School) %>%  ggplot(aes(x = Year, y = `Percent Pass`, fill = `Percent Pass`)) + geom_bar(stat="identity") + labs(title='Sterling Elementary Academic Performance', caption = "Source: VDOE \n No data for 2019/2020 due to COVID/school closure") + facet_wrap("Subject") 


EMS4 <- rbind(STER_eng, STER_math, STER_sci)
STEMS <- EMS4[which(EMS4$Subgroup=="All Students"),] 

STEMS %>% 
  arrange(Subject) %>% #the column you'd like to be arranged into order)   %>% 
  group_by(School) %>%  ggplot(aes(x = Year, y = `Percent Pass`, fill = `Percent Pass`)) + geom_bar(stat="identity") + labs(title='Sterling Elementary Academic Performance', caption = "Source: VDOE \n No data for 2019/2020 due to COVID/school closure") + facet_wrap("Subject")

```

## Sugarland
```{r}
SUG_All <- Sugar[which(Sugar$Subgroup=="All Students"),] 

#filter for only subjects
SUG_eng <- Sugar[which(Sugar$Subject=="English Reading"),] 
#Use ggplot
#plot(Year, STER_eng$`Percent Pass`)

SUG_math <- Sugar[which(Sugar$Subject=="Mathematics"),] 
#Use ggplot
#plot(Year, STER_math$`Percent Pass`)

SUG_sci <- Sugar[which(Sugar$Subject=="Science"),]
#Use ggplot
#plot(Year, STER_sci$`Percent Pass`)

SUG_All %>% 
  arrange(Subject) %>% #the column you'd like to be arranged into order)   %>% 
  group_by(School) %>%  ggplot(aes(x = Year, y = `Percent Pass`, fill = `Percent Pass`)) + geom_bar(stat="identity") + labs(title='Sugarland Elementary Academic Performance', caption = "Source: VDOE \n No data for 2019/2020 due to COVID/school closure") + facet_wrap("Subject")

EMS5 <- rbind(SUG_eng, SUG_math, SUG_sci)
SUTEMS <- EMS5[which(EMS5$Subgroup=="All Students"),] 

SUTEMS %>% 
  arrange(Subject) %>% #the column you'd like to be arranged into order)   %>% 
  group_by(School) %>%  ggplot(aes(x = Year, y = `Percent Pass`, fill = `Percent Pass`)) + geom_bar(stat="identity") + labs(title='Sugarland Elementary Academic Performance', caption = "Source: VDOE \n No data for 2019/2020 due to COVID/school closure") + facet_wrap("Subject")



```


## Sully
```{r}
SUL_All <- Sully[which(Sully$Subgroup=="All Students"),] 

#filter for only subjects
SUL_eng <- Sully[which(Sully$Subject=="English Reading"),] 
#Use ggplot
#plot(Year, STER_eng$`Percent Pass`)

SUL_math <- Sully[which(Sully$Subject=="Mathematics"),] 
#Use ggplot
#plot(Year, STER_math$`Percent Pass`)

SUL_sci <- Sully[which(Sully$Subject=="Science"),]
#Use ggplot
#plot(Year, STER_sci$`Percent Pass`)

SUL_All %>% 
  arrange(Subject) %>% #the column you'd like to be arranged into order)   %>% 
  group_by(School) %>%  ggplot(aes(x = Year, y = `Percent Pass`, fill = `Percent Pass`)) + geom_bar(stat="identity") + labs(title='Sully Elementary Academic Performance', caption = "Source: VDOE \n No data for 2019/2020 due to COVID/school closure") + facet_wrap("Subject")

EMS6 <- rbind(SUL_eng, SUL_math, SUL_sci)
SULTEMS <- EMS6[which(EMS6$Subgroup=="All Students"),] 

SULTEMS %>% 
  arrange(Subject) %>% #the column you'd like to be arranged into order)   %>% 
  group_by(School) %>%  ggplot(aes(x = Year, y = `Percent Pass`, fill = `Percent Pass`)) + geom_bar(stat="identity") + labs(title='Sully Elementary Academic Performance', caption = "Source: VDOE \n No data for 2019/2020 due to COVID/school closure") + facet_wrap("Subject")




```

# Other variables if interested

- Percent Proficiency
- Advance
- Fail
- Total number



# Do not delete, just my template
```{r}
#You could make x=year, y= pass rate, and facet_wrap by school

#Psuedo code:

#dataframe %>% 
#  arrange() %>% #the column you'd like to be arranged into order)   %>% 
#  group_by(subject) %>%  ggplot(aes(x = year, y = pass rate, fill = pass rate)) + geom_bar(stat="identity") #+ labs(title='') + facet_wrap(school)
# #+  scale_fill_viridis_c(breaks = c(breaks you’d like), option = "E") # change the option if you’d like to #change the theme of the palette
```
