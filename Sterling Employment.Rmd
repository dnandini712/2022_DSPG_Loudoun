---
title: "Employment Sterling"
author: "Abdullah Rizwan"
date: '2022-06-10'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(tidycensus)
library(viridis)
```

```{r}
library(readxl)
library(ggplot2)
library(dplyr)
library(tidyverse)
sterling <- read_excel("C:/Users/abdul/Downloads/DSPG/Employmentsterling.xlsx",skip=2,col_names=TRUE)
subset_sterling <- sterling[2:12,c(1, 2:5)]
subset_sterling$`EMPLOYMENT STATUS`
subset_sterling$Label <- as.factor(subset_sterling$`EMPLOYMENT STATUS`)
```
```{r}
sterling$...2[2:12]
employment_estimate <- sterling$...2[2:12]
employment_estimate<- as.numeric(gsub(",", "", employment_estimate))
emp_name <- subset_sterling$`EMPLOYMENT STATUS`
#summed_edu <- subset_sterling %>% 
 # group_by(`EMPLOYMENT STATUS`) %>%
  #summarize(edu_sum = sum(employment_estimate))
#summed_edu1 <- summed_edu[-(10:15),]
```

```{r}
ggplot(subset_sterling,aes(subset_sterling$Label, employment_estimate, fill = Label)) + geom_col() +
  theme(axis.text.x = element_text(angle=90))
```

```{r}

ggplot(subset_sterling,aes(subset_sterling$Label, employment_estimate, fill=Label)) + geom_col() +
  theme(axis.text.x = element_text(angle=90)) + coord_polar() + scale_y_log10()
```


Employment and unemloyment bar graph

```{r}
subset_sterling <- sterling[c(2, 7),]
inLabor <- as.numeric(sub("%", "", subset_sterling[1, "...4"]))
outLabor <- as.numeric(sub("%", "", subset_sterling[2, "...4"]))
subset_sterling[, "...4"] <- c(inLabor, outLabor)


ggplot(subset_sterling, aes(x = `EMPLOYMENT STATUS`, y = ...4, fill = `EMPLOYMENT STATUS`)) + geom_bar(position = "stack", stat="identity", width = 0.25) + labs(x = "Available to work", y= "percent population", caption = " Source : DP03 ACS data 2016-2020", title = "Labour force")+ guides(fill = guide_legend(title = "Labour Force"))
```
The graph shows us the percentage of the population that is part of the labor force which is 77.2% and also the percentage of population that is not in the labor force which is 22.8%

```{r}
sterling <- read_excel("C:/Users/abdul/Downloads/DSPG/Employmentsterling.xlsx",skip=2,col_names=TRUE)
subset_sterling <- sterling[(4:5), c(1,4)]
employed <- as.numeric(sub("%", "", subset_sterling[1, "...4"]))
unemployed <- as.numeric(sub("%", "", subset_sterling[2, "...4"]))
subset_sterling[, "...4"] <- c(employed, unemployed)


ggplot(subset_sterling, aes(x = `EMPLOYMENT STATUS`, y = ...4, fill = `EMPLOYMENT STATUS`)) + geom_bar(position = "stack", stat="identity", width = 0.25) + labs(x = "Employment Status", y= "Percentage population", caption = " Source : DP03 ACS 5-yr data 2016-2020", title = "Employment")+ guides(fill = guide_legend(title = "Employment"))+ scale_y_continuous(limits = c(0,80.0))
```

s
Commuting to work bar graph
```{r}
subset_sterling <- sterling[c(20:25),]
percNum <- c()
for(i in 1:6){
  percNum <- c(percNum, as.numeric(sub("%", "", subset_sterling[i, "...4"])))
}
subset_sterling[, "...4"] <- percNum
ggplot(subset_sterling, aes(x = `EMPLOYMENT STATUS`, y =(...4), fill = `EMPLOYMENT STATUS`)) +geom_bar(position = "stack", stat="identity", width = 0.5) + theme(axis.text.x = element_text(angle=45)) + labs(x = "", y = "", caption = " Source : DP03 ACS data 2016-2020")+ guides(fill = guide_legend(title = "Method of Commute"))+ coord_polar()## REALLY have to note it's a sqrt()#+ geom_bar(position = "stack", stat="identity", width = 0.5)
```
```{r}

slices <- c(20, 21, 22, 23, 24, 25)
lbls <- c("Drove Alone", "Carpooled", "Public Transportation", "Walked", "Other")
pct <- round(slices/sum(slices)*100)
lbls <- paste(lbls, pct) # add percents to labels
lbls <- paste(lbls,"%",sep="") # ad % to labels
pie(slices,labels = lbls, col=rainbow(length(lbls)),main="Pie Chart of Countries")
```
```{r}
my_colors <- c("#CA001B", "#1D28B0", "#D71DA4", "#00A3AD", "#FF8200", "#753BBD", "#00B5E2", "#008578", "#EB6FBD", "#FE5000", "#6CC24A", "#D9D9D6", "#AD0C27", "#950078")
slices.Races <- c(75.0, 14.9, 1.8, 0.4, 3.5, 4.3)
lbls.Races <- c("Drove Alone 75.0%", "Carpooled 14.9%", "Public Transport 1.8%", "Walked 0.4%","Other means 3.5%","Worked from home 4.3%")
pie(slices.Races, labels = lbls.Races, main="", sub = "Source: DP03 ACS data 2016-2020")
library(plotly)
labelsR = c("Drove Alone", "Carpooled", "Public Transport", "Walked","Other means","Worked from home")
valuesR = c(12922, 2574, 308, 77, 609, 741)
figR <- plot_ly(type='pie', labels=labelsR, values=valuesR, 
               textinfo='label+percent',
               insidetextorientation='radial') %>% layout(title ='', legend=list(title=list(text='')))
figR
```


The bar graph shows the different modes of commute. With driving alone being the  most popular one and walking is the least popular commute method to work. 

```{r}
library(plotly)


subset_sterling <- sterling[c(20:25),]
percNum <- c()
for(i in 1:6){
  percNum <- c(percNum, as.numeric(sub("%", "", subset_sterling[i, "...4"])))
}
subset_sterling[, "...4"] <- percNum
ggplot(subset_sterling, aes(x = `EMPLOYMENT STATUS`, y = (...4), fill = `EMPLOYMENT STATUS`)) + geom_bar(position = "stack", stat="identity", width = 0.5)+ theme(axis.text.x = element_text(angle=90)) + labs(x = "Commute", y = "Percentage", caption = " Source : DP03 ACS data 2016-2020")+ guides(fill = guide_legend(title = "Method of Commute"))  #+ coord_polar()## REALLY have to note it's a sqrt()

# sterling <- data.frame("Categorie"=rownames(sterling), sterling)
# percNum <- c(percNum, as.numeric(sub("%", "", sterling[i, "...4"])))
# data <- sterling[,c('Categorie', 'percNum')]
# 
# fig <- plot_ly(data, labels = ~Categorie, values = ~percNum, type = 'pie')
# fig <- fig %>% layout(title = 'United States Personal Expenditures by Categories in 1960',
#          xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE),
#          yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))
# 
# fig

```


bar graph for occupation 
```{r}
subset_sterling <- sterling[c(29:33),]
percNum <- c()
for(i in 1:5){
  percNum <- c(percNum, as.numeric(sub("%", "", subset_sterling[i, "...4"])))
}
subset_sterling[, "...4"] <- percNum
ggplot(subset_sterling, aes(x = `EMPLOYMENT STATUS`, y = (...4), fill = `EMPLOYMENT STATUS`)) + geom_bar(position = "stack", stat="identity", width = 0.5)+ theme(axis.text.x = element_text(angle=90), legend.position="none") + labs(x = "Occupations", y = "Percentages", caption = " Source : DP03 ACS 5-yr data 2016-2020", title = "Work Occupations") + coord_flip()
```

The bar graph shows the population percentage and their occupations. Management, business, science, and arts occupation is the most popular occupation in the sterling area. Production and transportation occupation is the least popular which tells us that sterling area is less of a industrial area and more of a corporate area which offers more of the service industry. 